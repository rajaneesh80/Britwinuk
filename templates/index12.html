<html>
    <head>
        <title>
            Excel file upload and processing : Django Example : ThePythonDjango.Com
        </title>
    </head>
    <body style="margin-top: 30px;margin-left: 30px;">
<div>
  <table class="table">
  
  <tbody>
        {% for row in excel_data %}
        <thead>          
            <tr>
            {% for cell in row %}

            <th scope="col"></th>
            <td style="width:15%">
                {{ cell }}
            </td>
            {% endfor %}
          </tr>
        </thead>
        {% endfor %}
        </tbody>
</table>
</div>
    </body>
</html>

<!-- # class stockListView(ListView):

#     model = stock
#     paginate_by = 100  # if pagination is desired

     # def get_context_data(self, **kwargs):
     #    context = super().get_context_data(**kwargs)
     #    context['now'] = timezone.now()
     #    return context




# Create your views here.
# Imaginary function to handle an uploaded file.
# from somewhere import handle_uploaded_file

# def upload_file(request):
#     if request.method == 'POST':
#         form = UploadFileForm(request.POST, request.FILES)
#         if form.is_valid():
#             handle_uploaded_file(request.FILES['file'])
#             return HttpResponseRedirect('/success/url/')
#     else:
#         form = UploadFileForm()
#     return render(request, 'upload.html', {'form': form})

# def index(request):
#   return render(request, 'index.html',{})
#     return HttpResponse("Hello, world. You're at the polls index.")

# def index(request):
#     if "GET" == request.method:
#         return render(request, 'index.html', {})
#     else:
#         excel_file = request.FILES["excel_file"]

#         # you may put validations here to check extension or file size

#         wb = openpyxl.load_workbook(excel_file)

#         # getting a particular sheet by name out of many sheets
#         worksheet = wb["Sheet1"]
#         #print(worksheet)

#         excel_data = list()
#         # iterating over the rows and
#         # getting value from each cell in row
        
#         j=0
#         for row in worksheet.iter_rows():
#             s=stock()
#             row_data = list()
            
#             i=0
#             print(row)
#             for cell in row:

#                 if i==0 and j!=0:
#                     s.sku=cell.value
#                 if i==1 and j!=0:
#                     s.skusize=cell.value
#                 if i==2 and j!=0:
#                     s.color=cell.value
#                 if i==3 and j!=0:
#                     s.buyprice=cell.value
#                 if i==4 and j!=0:
#                     s.style=cell.value
#                 if i==5 and j!=0:
#                     s.colornum=cell.value
#                 if i==6 and j!=0:
#                     s.size=cell.value
#                 if i==7 and j!=0:
#                     s.barcode=cell.value
#                 if i==8 and j!=0:
#                     s.quantity=cell.value
#                     try:
#                         #t=stock.objects.filter(barcode = s.barcode)

#                         s.save()
#                     except DatabaseError as e:
#                         pass
#                 i+=1
#                 #print(cell.value)
#                 row_data.append(str(cell.value))
#             j=1
            
#             excel_data.append(row_data)
            
#         return render(request, 'index1.html', {"excel_data":excel_data})
#          -->